<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>



  <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.3"/>




  <meta name="keywords" content="Hexo,next" />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.3" />



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    analytics: {
      google: ''
    },
    sidebar: 'hide'
  };
</script>




  <title> Be smart and make thins done </title>
</head>

<body>
  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->

  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">Be smart and make thins done</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<div class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            <i class="menu-item-icon icon-categories"></i> <br />
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            <i class="menu-item-icon icon-about"></i> <br />
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            <i class="menu-item-icon icon-archives"></i> <br />
            Archives
          </a>
        </li>
      
    </ul>
  

  
</div>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <div id="posts" class="posts-expand">
    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/05/19/Yale-open-class-notes/">
                耶鲁大学《有关实物的心理学、生物学和政治学》笔记
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-05-19
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/生活/">生活</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/05/19/Yale-open-class-notes/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/05/19/Yale-open-class-notes/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h1 id="第一课在现代生活里，我们该如何关注食物">第一课在现代生活里，我们该如何关注食物</h1><p>提出问题：</p>
<p>人们为什么喜欢吃哈根达斯，而不喜欢吃青菜 </p>
<ul>
<li>一瓶黑色的水叫什么——可乐</li>
<li>一瓶黄色的水叫什么——芬达</li>
<li>一瓶无色的水叫什么——雪碧</li>
</ul>
<h1 id="第二课_过去到现在，饮食条件的演化">第二课 过去到现在，饮食条件的演化</h1><p>1、饥荒是最大的威胁。<br>2、<br>问题：为什么身体能从一种实物中获得高度愉悦感（<code>higly pleasant</code>）嫉妒满足 甚至感到安抚，但却感觉其他实物难以下咽？</p>
<p>有些人现在已经开始抵制高脂肪食物、又或者在文化背景下，有些人喜欢西兰花甚过哈根达斯，但这违背了大脑的意愿。</p>
<p>归因于我们的祖先，由于祖先传承下来的。在特性时期的饮食结构决定的。因此科学家们提出一个概念 <code>节俭代谢</code> (thrifty metabolism 充分利用卡路里)。如果想想周围我们认识的人，你可能意识到个人的进食量以及储存能量的能力之间存在相当大的差异。有的人吃饭一定要找免费加饭的餐厅，否则吃不饱。身体脂肪就是这些能力的储存库，如果你摄入的热量超过消耗的，热量就会存储在脂肪细胞中，这些能量库你可以在食物不够以及接或者饥荒的时候利用它，每个人存储能量的效率个不同。</p>
<p>那么问题，那为什么我们身边总有有些人怎么吃都不会发胖的人，这些人是令人羡慕的。还有一类人非常注意控制饮食，但是仍然容易发胖。答案是 <code>代谢差异</code> 的问题,热量摄入 食物消耗 机体新陈代谢 利用那些营养物质。这过程中人体内有个工作这的代谢引擎（感觉跟 CPU 一样哈哈），有些人的代谢引擎效率较高，热量便转化为脂肪粗存起来。另一些人的代谢引擎底下，能量就以体温等形式被浪费了。因此他们不容易发胖。</p>
<p>而能高效率储存能量的代谢系统，在食物短缺的情况下非常重要，有着较强的适应能力，但却不能适应现代发达国家的食品环境。</p>
<p>这些行为出于天性地与生俱来，从各方面显露出来，这意味着只要周围有食物我们就想吃。不管自己是否真的饿了。尽管自己有时候已经吃撑了，我们仍会眼前的美味所迷惑。机体寻求脂肪、糖或是其他食物，大量进食成了首要任务。</p>
<p>如我们所见，在世界范围内肥胖盛行，与饮食相关的疾病、发病率正在上升。因此 抵制这些东西就显得尤其重要，比如一些专家们提倡的 低脂肪饮食，和阿特金斯的低碳饮食，即使是像靠出版食谱书赚大钱的专家们也有自己的偏好食物，吃什么和如何确定最佳食谱成为冲突的两个问题。</p>
<table>
<thead>
<tr>
<th>祖先</th>
<th style="text-align:center">-</th>
<th style="text-align:right">现代人</th>
</tr>
</thead>
<tbody>
<tr>
<td>35%</td>
<td style="text-align:center">脂肪</td>
<td style="text-align:right">33%</td>
</tr>
<tr>
<td>8%</td>
<td style="text-align:center">饱和脂肪</td>
<td style="text-align:right">12%</td>
</tr>
<tr>
<td>35%</td>
<td style="text-align:center">碳水化合物</td>
<td style="text-align:right">50%</td>
</tr>
<tr>
<td>2.5%</td>
<td style="text-align:center">添加糖类</td>
<td style="text-align:right">15%</td>
</tr>
<tr>
<td>30%</td>
<td style="text-align:center">蛋白质</td>
<td style="text-align:right">15%</td>
</tr>
<tr>
<td>50%</td>
<td style="text-align:center">水果蔬菜</td>
<td style="text-align:right">16%</td>
</tr>
<tr>
<td>&gt; 100g/d</td>
<td style="text-align:center">纤维素</td>
<td style="text-align:right">15g/d</td>
</tr>
</tbody>
</table>
<p><code>脂肪：</code>相差无几。</p>
<p><code>饱和脂肪：</code>脂肪种发生了很大变化，人们越来越少从植物中摄取脂肪，而更多是从内类食物中获得。肉类含有饱和脂肪酸，而过多地摄取饱和脂肪酸是有害的。</p>
<p><code>碳水化合物：</code>也有显著提升，现代人更多从碳水化合物中摄取能量</p>
<p><code>添加糖类：</code>祖先糖类原料主要来源于蜂蜜，而现在糖无处不在，而人天生就喜欢甜味。如果你从事饮食行业，就可以把你的食物变甜。用户就会更喜欢你的产品，至少跟竞争对手比起来适合这样的。</p>
<p><code>蛋白质和水果蔬菜:</code> 毫无以为，我们应该更多的吃水果和蔬菜。</p>
<p><code>纤维素:</code> 我们和祖先的摄入量相去甚远，纤维素可以抵抗一些疾病，尤其是某些癌症。因此我们相比祖先对某些疾病的抵抗力就低。纤维素摄入量不仅取决于人们选择的食物，还要看食物加工的过程，因为食物加工过程中会流失掉。</p>
<p>为什么脂肪比蛋白质或碳水化合物更能让机体变强，因为单位重量中的脂肪热量含量是蛋白质和碳水化合物的两倍，因此脂肪才是最能维持生存的物质。</p>
<p>书籍：<a href="http://book.douban.com/subject/1315187/" target="_blank" rel="external">植物的欲望</a> 书中假定人类依赖于植物和动物，同时动物的演化也依赖人类。两只的演化过程相互依存  相关书籍 <code>人类简史</code></p>
<h1 id="第三课_为了营养和健康，我们该吃什么">第三课 为了营养和健康，我们该吃什么</h1><p>反式脂肪 比 饱和脂肪 有害<br>多不饱和脂肪 单不饱和脂肪 均属于有害的<br>人们认为脂肪是有害的，但却步知道脂肪分很多种（不问是不是就问为什么）</p>
<p>减肥方法成千上万，最有效的是什么 教人减肥的书籍一直处于畅销排行榜上<br>但是那种方法减肥最有效呢</p>
<p>有人主张 低脂饮食  低卡路里饮食 低碳水化合物饮食（如阿特金斯饮食）<br>很不幸，答案是都不可取的。食品减肥的作用不明显。正是因为如何最畅销书榜上才总有减肥食品的书上榜。</p>
<p>换个角度想一想，如果真有用人们就不会再三寻找减肥的办法了 ，随便在电视看个小技巧就要尝试</p>
<p>营养学领域中，</p>
<p>食物  被定义成  供食用 消化 吸收 并至少含有一种营养素的物质 </p>
<p>营养素 包含在食物中的物质 由人体消化 吸收 推动身体机能 必须具有值得人类去代谢的健康价值</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/03/19/AnyObject-Objective-C-Compatiblility/">
                AnyObject: 与 Objective-C 兼容
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-03-19
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/iOS/">iOS</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/03/19/AnyObject-Objective-C-Compatiblility/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/03/19/AnyObject-Objective-C-Compatiblility/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>众所周知，Objective-C 是 C 语言的超集，苹果借鉴了 Smalltalk 的面向对象和消息机制的思想对 C 语言进行了一套封装。既然是 C 语言的超集，那么在 Objective-C 环境执行C程序肯定没问题的。2014年 Swift 在 <a href="https://developer.apple.com/wwdc/" target="_blank" rel="external">Apple WWDC</a> 发布, 并且苹果大力推崇的情况下很有可能往后成为 iOS 平台上主流开发语言。但是现如今大部分公司和开发者还在使用 Objective-C 进行开发，为了更让开发者平稳过渡到 Swift 上的话，就肯定需要跟 Objective-C 兼容。</p>
<p>苹果在兼容两个语言的时候遇上了很多麻烦，现在 Swift 也能使用原有的 Objective-C API，但是有一些特殊的数据类型在两种语言进行交接的时候</p>
<pre><code><span class="built_in">NSString</span> 桥接成 String
<span class="built_in">NSArray</span> 桥接成 Array&lt;AnyObject&gt;    
<span class="built_in">NSDictionary</span> 桥接成 Dictionary&lt;<span class="built_in">NSObject</span>, AnyObject&gt;
Int,Float,Double,Bool 桥接成 <span class="built_in">NSNumber</span>
</code></pre><p>苹果神奇的将他们连接了起来，使得我们可以随意进行转换</p>
<pre><code>let length = (someString as NSString)<span class="class">.length</span> <span class="comment">//length 是 NSSring 的方法</span>
(someArray as NSSArray).<span class="function"><span class="title">componentJoinedByString</span><span class="params">(NSString)</span></span>
</code></pre><p>Property List </p>
<p>Propery List 不是一种类型，它属于一种工具类的东西，表面上是 AnyObject 但是背后里他是 NSString, NSArray, NSDictionary, NSNumber, NSData, NSDate 六种类型其中一种 或是桥接到 Swift 里的版本。</p>
<p>为什么我们要用 Property List, 既然它是 AnyObject 我们使用起来就必须要 as 或 is 进行大量的类型转换。实际上主要原因有两个</p>
<p>第一 用来隐式传递数据，类似于浏览器中的 Cookie，只有创建者才知道的如何解释的一组数据，只有创建者才知道 Property List 里面是 六种数据类型中的哪一种，对于其他人来说它们就是 AnyObject 但不知道具体是什么。其他人能做的就是把数据传送，提现了很好的封装性。</p>
<p>第二 用于泛型数据结构，可以把一个数据结构变成一个泛型的数据结构。就好像 Enum 类型不是泛型，但是我们可以把它变成泛型的。</p>
<p>还有一个好处就是 NSUserDefaults， 它只存储 Property List，通常用来存储用户数据、偏好设置什么的。由于它性能不高，不要用它来存储图片或者比较大的数据。由于它本身就是一个字典，我们可以像操作字典一样来操作它。</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/03/18/swift-what-is-the-anyObject/">
                Swift: 什么是 AnyObject
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2015-03-18
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/iOS/">iOS</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/03/18/swift-what-is-the-anyObject/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/03/18/swift-what-is-the-anyObject/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="什么是AnyObjct">什么是AnyObjct</h2><p>为了方便理解你可以将 <code>AnyObject</code> 类比成一种类型，就像 <code>Array</code> 或 <code>Double</code> 一样，但事实上它并不是一种类型。它主要用于兼容现有的 Objective-c API 和 iOS 代码， <code>AnyObject</code> 可以用来构建自己的数据结构，但并不经常使用。这有点不像 Swift，因为 Swift 是强类型语言，并且有类型推断的特性。 <code>AnyObject</code> 是只想一个对象（未知类）的指针，这有点奇怪哈。</p>
<h2 id="什么时候用到_AnyObject">什么时候用到 AnyObject</h2><p>有可能在变量中见到：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">var</span> destinationViewController</span>: AnyObject</span><br><span class="line"><span class="variable"><span class="keyword">var</span> toolbarItems</span>: [AnyObject]</span><br></pre></td></tr></table></figure>
<p>或者在方法参数中出现：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">prepareForSegue</span><span class="params">(segue: UIStoryboardSegue, sender: AnyObject)</span></span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">addConstraints</span><span class="params">(constrains: [AnyObject])</span></span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">appendString</span><span class="params">(sender: AnyObject)</span></span></span><br></pre></td></tr></table></figure>
<p>甚至可以作为一个方法的返回值：</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="function"><span class="keyword">function</span> <span class="title">buttonWithType</span><span class="params">(buttonType: UIButtonType)</span> -&gt; <span class="title">AnyObject</span></span></span><br></pre></td></tr></table></figure>
<p>在我们使用 Storyboard 进行连线时候出现：</p>
<h2 id="如何使用_AnyObject">如何使用 AnyObject</h2><p>既然它是指针，我们就不可能发送任何消息给它。<code>为了使用它，我们要把它转换成一种我们已知的类型，这也是我们唯一使用它的方式</code> 例如：</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> destinationViewController: AnyObject</span><br><span class="line"><span class="keyword">let</span> planVC = destinationViewController <span class="keyword">as</span> planInfoViewController</span><br></pre></td></tr></table></figure>
<p>如果 dvc 为空，会 Crash</p>
<p>安全转换有两种办法避免：</p>
<figure class="highlight nimrod"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> planVC = destinationViewController <span class="keyword">as</span>? planInfoViewController <span class="decorator">&#123;...&#125;</span> // <span class="keyword">as</span>? 会返回一个 <span class="type">Optional</span> 版本</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight nimrod"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> destinationViewController <span class="keyword">is</span> planInfoViewController <span class="decorator">&#123;...&#125;</span> //如果 <span class="literal">true</span> 那么就可以进行 <span class="keyword">as</span> 操作了</span><br></pre></td></tr></table></figure>
<p>我更喜欢第一种，检查与转换一次搞定。</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2014/08/18/ios-notes-multi-version-compatibility-skills/">
                iOS 开发 —— 多版本系统兼容五个技巧
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2014-08-18
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/iOS/">iOS</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2014/08/18/ios-notes-multi-version-compatibility-skills/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2014/08/18/ios-notes-multi-version-compatibility-skills/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h1 id="前言">前言</h1><p>刚进公司一周，正在熟悉公司代码业务。由于之前的小伙伴使用了 iOS 7 SDK 中提供的 <code>setSeparatorInset</code> 方法（消息），同时没有对 iOS 7以下的系统进行测试，导致系统还是 iOS 6版本的用户 Crash。</p>
<p>问题处理之后，晚上收集了常用的处理 iOS 多版本系统兼容的处理办法，下面做个总结。</p>
<h3 id="0、首先你需要知道_Deployment_Target_和_Base_SDK">0、首先你需要知道 Deployment Target 和 Base SDK</h3><ul>
<li><strong>Deployment Target</strong> 可以字面意思理解就好，就是你希望所开发的 App 支持的最低系统版本。</li>
<li><strong>Base SDK</strong> 用来编译APP的SDK（Software Development Kit）的版本，一般保持跟当前 XCode 所支持的最高版本。这样你才能使用苹果每次升级系统，新推出的各种 API 新特性。因此，一般情况下 Base SDK 都会高于 Deployment Target 的版本。那么问题来了，你在项目用使用了当前 Base SDK 版本里面的特性，编译会通过，但是 App 的手机系统版本低于 Base SDK 就会 Crash 了。就跟前言提到的一样。</li>
</ul>
<h3 id="1、使用_NSClassFromString_检查对象是否可用">1、使用 NSClassFromString 检查对象是否可用</h3><pre><code>Class klass =<span class="function"> NSClassFromString(</span>@<span class="string">"SomeClass"</span><span class="function">)</span>;<span class="instruction">
if </span>(klass<span class="function">)</span> {
    // class exists
    id<span class="instruction"> instance </span>= <span class="keyword">[</span><span class="keyword">[</span>klass alloc] init];
} else {
    // class doesn't exist
}
</code></pre><h3 id="2、使用宏进行编译时判断运行时系统版本">2、使用宏进行编译时判断运行时系统版本</h3><p>宏只是一种预定义的文本替换，只在编译时有用。主要用到两个系统预设的宏定义</p>
<p><code>__IPHONE_OS_VERSION_MIN_REQUIRED</code> 等价于 Deployment Target<br><code>__IPHONE_OS_VERSION_MAX_ALLOWED</code>  等价于 Base SDK</p>
<p>例如需要检查 UITableViewCell 的 <code>setSeparatorInset</code> 方法。（宏可以嵌套出现）</p>
<pre><code><span class="comment">// 编译时判断：检查SDK版本</span>
<span class="preprocessor">#<span class="keyword">if</span> __IPHONE_OS_VERSION_MAX_ALLOWED &gt; 80000</span>
    <span class="comment">// 运行时判断：检查当前系统版本</span>
    <span class="keyword">if</span> ([UIDevice currentDevice].systemVersion.floatValue &gt; <span class="number">8.0f</span>) {
        <span class="comment">// 使用 setSeparatorInset...</span>
    } <span class="keyword">else</span> {
        <span class="comment">// 使用别的解决方案...</span>
    }
<span class="preprocessor">#<span class="keyword">else</span></span>
    <span class="comment">// ...</span>
<span class="preprocessor">#<span class="keyword">endif</span></span>
</code></pre><h3 id="3、使用_Weakly_Linked_特性做运行时的检查（iOS4-2_and_greater）">3、使用 Weakly Linked 特性做运行时的检查（iOS4.2 and greater）</h3><p>这个特性是基于 iOS4.2系统提供的 <code>NS_CLASS_AVAILABLE</code> 才能使用的</p>
<pre><code><span class="keyword">if</span> ([SomeClass <span class="class"><span class="keyword">class</span>]) {</span>
    // <span class="class"><span class="keyword">class</span> <span class="title">exists</span></span>
    SomeClass *instance = [[SomeClass alloc] init];
} <span class="keyword">else</span> {
    // <span class="class"><span class="keyword">class</span> <span class="title">doesn</span>'<span class="title">t</span> <span class="title">exist</span></span>
}
</code></pre><p>对方法进行判断</p>
<pre><code><span class="tag">if</span> ([UITableViewCell <span class="attribute">instancesRespondToSelector</span>:<span class="variable">@selector</span> (<span class="attribute">setSeparatorInset</span>:)]) {
    <span class="comment">//  使用 setSeparatorInset...</span>
} <span class="tag">else</span> {
    <span class="comment">// 使用别的解决方案...</span>
}
</code></pre><p><em>同时还可以进行 Framework 进行引用 TARGETS-&gt;Build Phases-&gt;Link Binary With Libraries 选择该 Framework，将 Required 改为 Optional</em></p>
<h3 id="4、用_Method_Swizzling_替换系统方法">4、用 Method Swizzling 替换系统方法</h3><p>在iOS 6中 UILabel的背景默认是白色，而 iOS6以后则是透明的，如果在每个用到 UILable 的地方，都需要手动设置一次背景颜色，既繁琐又容易遗漏。这种情况就可以通过 Runtime 动态的特性在运行时把系统的方法替换掉，实现自己想要的效果了。</p>
<pre><code><span class="class"><span class="keyword">@implementation</span> <span class="title">UILabel</span> (<span class="title">XSCompatibility</span>)</span>


+ (<span class="keyword">void</span>)load {
 <span class="keyword">if</span> ([<span class="built_in">UIDevice</span> currentDevice]<span class="variable">.systemVersion</span><span class="variable">.floatValue</span> &lt; <span class="number">7.0</span>f) {

        <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;
        <span class="built_in">dispatch_once</span>(&amp;onceToken, ^{
            Class class = [<span class="keyword">self</span> class];

            SEL originalSelector = <span class="keyword">@selector</span>(initWithFrame:);
            SEL swizzledSelector = <span class="keyword">@selector</span>(compatible_initWithFrame:);

            Method originalMethod = class_getInstanceMethod(class, originalSelector);
            Method swizzledMethod = class_getInstanceMethod(class, swizzledSelector);

            <span class="built_in">BOOL</span> didAddMethod =
                class_addMethod(class,
                    originalSelector,
                    method_getImplementation(swizzledMethod),
                    method_getTypeEncoding(swizzledMethod));

            <span class="keyword">if</span> (didAddMethod) {
                class_replaceMethod(class,
                    swizzledSelector,
                    method_getImplementation(originalMethod),
                    method_getTypeEncoding(originalMethod));
            } <span class="keyword">else</span> {
                method_exchangeImplementations(originalMethod, swizzledMethod);
            }
        });
    }
}

<span class="comment">// initWithFrame</span>
- (<span class="keyword">id</span>)compatible_initWithFrame:(<span class="built_in">CGRect</span>)frame {
    <span class="keyword">id</span> newSelf = [<span class="keyword">self</span> compatible_initWithFrame:frame];
    <span class="comment">// 设置透明背景色</span>
    ((<span class="built_in">UILabel</span> *)newSelf)<span class="variable">.backgroundColor</span> = [<span class="built_in">UIColor</span> clearColor];
    <span class="keyword">return</span> newSelf;
}

<span class="comment">// initWithCoder...</span>
</code></pre><h3 id="5、运行时添加动态添加方法，减少代码改动">5、运行时添加动态添加方法，减少代码改动</h3><p>以 UITableViewCell 的 <code>setSeparatorInset:</code> 方法为例，在iOS6中找不到 <code>separatorInset:</code> 方法的时候就会 Crash。那就进行添加一个方法进行消息接收就可以了。</p>
<pre><code><span class="class"><span class="keyword">@implementation</span> <span class="title">UITableViewCell</span> (<span class="title">XSCompatibility</span>)</span>

+ (<span class="keyword">void</span>)load {

<span class="preprocessor">#if __IPHONE_OS_VERSION_MAX_ALLOWED &gt; __IPHONE_7_0</span>

    <span class="keyword">if</span> ([<span class="built_in">UIDevice</span> currentDevice]<span class="variable">.systemVersion</span><span class="variable">.floatValue</span> &lt; <span class="number">7.0</span>f) {
        Method newMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(compatible_setSeparatorInset:));

        class_addMethod(
                <span class="keyword">self</span>,
                <span class="keyword">@selector</span>(setSeparatorInset:),
                method_getImplementation(newMethod),
                method_getTypeEncoding(newMethod));
    }
<span class="preprocessor">#endif</span>
}


- (<span class="keyword">void</span>) compatible_dummySetSeparatorInset:(<span class="built_in">UIEdgeInsets</span>) inset {

}
</code></pre><h1 id="总结">总结</h1><p>虽然 Apple 每次发布 iOS 系统更新，用户都能积极响应进行更新。但是想让全部用户都更新那是不可能的，所以想让 App 提供给更多的用户使用，以上五种方法应该会对你有用。根据自己的场景选择相应的方法进行处理。任何一种方法滥用都是耍流氓。</p>
<h1 id="参考">参考</h1><ul>
<li><p><a href="https://developer.apple.com/library/ios/documentation/DeveloperTools/Conceptual/cross_development/Introduction/Introduction.html#//apple_ref/doc/uid/10000163-BCICHGIE" target="_blank" rel="external">SDK Compatibility Guide</a></p>
</li>
<li><p><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/RevisionHistory.html" target="_blank" rel="external">Objective-C Runtime Programming Guide</a></p>
</li>
<li><p><a href="http://stackoverflow.com/questions/3057325/weak-linking-check-if-a-class-exists-and-use-that-class" target="_blank" rel="external">Weak Linking - check if a class exists and use that class</a></p>
</li>
<li><p><a href="http://stackoverflow.com/questions/19789958/xcode-preprocessor-macro-to-check-if-base-sdk-ios-7-0" target="_blank" rel="external">Xcode preprocessor macro to check if Base SDK &gt;= iOS 7.0</a></p>
</li>
<li><p><a href="http://stackoverflow.com/questions/3027120/how-to-make-iphone-app-compatible-with-multiple-sdk-firmware-versions" target="_blank" rel="external">How To Make iPhone App compatible with multiple SDK (firmware) versions</a></p>
</li>
</ul>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2014/08/03/read-notes-why-games-make-us-better/">
                读书笔记 ——《游戏改变世界》 
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2014-08-03
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/生活/">生活</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2014/08/03/read-notes-why-games-make-us-better/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2014/08/03/read-notes-why-games-make-us-better/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>  相信大部分少年跟我一样的沉迷过无数游戏。单机的、射击的、回合的、剧情的、角色扮演等等。从小霸王到PS4、XBOX One，从 CS、红警到 PC 网游，再到现如今的手游。我曾为了游戏曾在小伙伴家中排一个多小时队才能摸到红白机手柄，曾每月剩下零花钱甚至早餐钱只为充游戏点卡。甚至给母亲半夜从网吧抓回家中，依然爬墙返回到游戏的战场中。在没有读《游戏改变世界》之前，自己一直无法解释。为什么人们那么喜欢玩游戏，小时候也没有能力去探究。只是所有的大人都认为游戏让人丧失心智，堕落。</p>
<h2 id="为什么游戏吸引人呢?">为什么游戏吸引人呢?</h2><p><strong>书中前言提出</strong></p>
<blockquote>
<p>游戏满足了现实世界无法满足的真实人类需求，带来了现实世界提供不了的奖励，它们以现实世界做不到的方式教育我们，鼓励我们，打动我们，以现实世界实现不了的方式把我们联系在一起，我们很“饥渴”，游戏填饱了我们，对更满意工作的饥渴，对强烈族群感的饥渴以及对更有意义的人生的饥渴。</p>
</blockquote>
<p><strong>书中提到的主要原因有三点</strong></p>
<p><strong>即时反馈</strong></p>
<p>我们在游戏中的任何操作，都会立即视觉化、数据化地呈现出来，例如：打一个怪，得多少经验。下一次副本，得多少游戏道具。对比工作的时候，我们无法知道老板什么时候给我们加薪升职。看书写作业无法知道期末考试自己考得多少分。而游戏你可以清晰知道自己差多少经验就升级了。</p>
<p><strong>循序渐进、可实现的规则与目标（信心预期）</strong></p>
<p>游戏永远不会从你一进入游戏穿着布衣手拿木剑，就让你去下副本。而是通过一系列的规则，去某个地方获取某种原料合成牛逼的装备，做某一项任务得多少经验和游戏币奖励，去一个符合你自己等级的场景进行打怪升级。</p>
<p><strong>协作与成就感</strong></p>
<p>组队打怪升级，拯救世界。就算是疯狂的小鸟也有为了保护自己的孩子给野猪吃掉的使命。</p>
<h2 id="游戏将会对我们生活有哪些影响？">游戏将会对我们生活有哪些影响？</h2><p><strong>对紧急事件的积极心态</strong> </p>
<p>紧急乐观可以想象成是极端的自我激励，急切的乐观精神结合着自己必胜的信念以及立即解决障碍的渴望，游戏玩家永远相信不可能的胜利也是可能的</p>
<p><strong>擅长组件严密的社会结构</strong></p>
<p>有一项研究表明，我们更喜欢和我们一起玩游戏的人，即便他们把你打败了，亦是如此。原因是，在游戏过程中我们积累了饿信任，我们之所以信任，就是因为他们和我们话费的同样的时间，遵守了同样的规则，拥有着共同的目标，并肩作战直到游戏结束。基于这些观点，一款游戏可以建立默契、信任和协作。进而建立一个更强健的社会关系网络</p>
<p><strong>幸福的生产力</strong></p>
<p>平均魔兽世界的玩家一周花费22个小时，就像在兼职一份工作一样。因为玩游戏相对于休闲或逛街来说，我们加倍玩游戏会让我们更开心。作为人类而言，我们更喜欢做哪些虽然很难但是更有趣的事情（工作），如果提供一个合适的任务给玩家，玩家就会一直不停地努力玩下去。</p>
<p><strong>史诗的含义</strong></p>
<p> 游戏玩家喜欢依附在那些关乎人类星际故事的威严任务里面，你所做的任何一点点琐事都会成为那个最终的美好愿景的一部分。众所周知全球最大的 wiki (多人协作创作的超文本系统) 是<a href="https://zh.wikipedia.org/wiki/Wikipedia:%E9%A6%96%E9%A1%B5" target="_blank" rel="external">维基百科</a>,而第二大的 wiki 就是魔兽世界 wiki，里面大概有八万篇文章，每个月超过500万人在使用它。这就创建了一个史诗般的故事。</p>
<h2 id="总结">总结</h2><p>游戏玩家们是一个被高度授权、极具希望的群体，他们都认为自己具有改变世界的能力。唯一不同的是，他们相信他们能改变的世界是虚拟世界，而不是现实世界。这正是科学家们现在需要解决的难题。当我们从书中学习到了游戏针对 <strong>人性弱点</strong> 设计原理后，并不是像小时候所有家长所唾弃的那样游戏都是不好的（万恶的游戏），而是换一个角度看问题，如果我们把这些原理运用到学习或生活中。比如可以建立自己的学习反馈系统，看完一本书就给自己买一样物质东西，学习一个小时，就吃一个水果等。让生活、学习也借此变得让人上瘾。</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/10/17/ios-dev-block-theory/">
                iOS 开发 —— Block 原理
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-10-17
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/iOS/">iOS</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2013/10/17/ios-dev-block-theory/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2013/10/17/ios-dev-block-theory/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>在OC中提供一个块代码，类似 javaScript 中的闭包(值捕获)。先来看一个例子</p>
<pre><code><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</span>
</span>{
    <span class="annotation">@autoreleasepool</span> {

        <span class="comment">//__block int temp = 10;</span>
        <span class="keyword">int</span> temp = <span class="number">10</span>;
        <span class="keyword">void</span> (^block)() = ^{ <span class="comment">// 值捕获</span>
            NSLog(@<span class="string">"temp=%d"</span>, temp);
        };

        temp = <span class="number">20</span>;
        block();
    }
    <span class="keyword">return</span> <span class="number">0</span>;
}
</code></pre><p>答案是：temp = 10。那么如果在 temp 前面加了 __blcok 修饰符 temp = 20，这是为什么呢？</p>
<p>接下来我们使用 clang -rewrite-objc 指令将 OC 代码转换成 C++ 代码，执行完毕之后。我们会得到一个 9万多行的 .cpp 文件，也就是说我们上面写的 几行代码，居然编译出 9万多行的代码。打开文件 直接拖到最下面，找到我们的 main 函数。</p>
<pre><code>int main<span class="params">(int argc, const char * argv[])</span>
{
    <span class="comment">/* @autoreleasepool */</span> { __AtAutoreleasePool __autoreleasepool; 
        int temp = <span class="number">10</span>;
        void <span class="params">(*block)</span><span class="params">()</span> = <span class="params">(void <span class="params">(*)</span><span class="params">()</span>)</span>&amp;__main_block_impl_0<span class="params">(<span class="params">(void     *)</span>__main_block_func_0, &amp;__main_block_desc_0_DATA, temp)</span>;
        temp = <span class="number">20</span>;
        <span class="params">(<span class="params">(void <span class="params">(*)</span><span class="params">(__block_impl *)</span>)</span><span class="params">(<span class="params">(__block_impl *)</span>block)</span>-&gt;FuncPtr)</span>    <span class="params">(<span class="params">(__block_impl *)</span>block)</span>;
    }
    return <span class="number">0</span>;
}
</code></pre><p>由编译后的C++代码可以看出，没有加 __block 修饰符的 temp 是直接将 自己本身的值传递到 Block 中（值捕获）了。 这个时候你在怎么修改 temp 的值，都已经跟 Block 无关了。所以 temp 的值不会改变。</p>
<p>接下来我们再看一下 加了 __block 修饰符的 temp 生成的代码是怎样的。</p>
<pre><code>int main<span class="params">(int argc, const char * argv[])</span>
{
    <span class="comment">/* @autoreleasepool */</span> { __AtAutoreleasePool __autoreleasepool; 
        __attribute__<span class="params">(<span class="params">(__blocks__<span class="params">(byref)</span>)</span>)</span> __Block_byref_temp_0 temp = {<span class="params">(void*)</span><span class="number">0</span>,<span class="params">(__Block_byref_temp_0 *)</span>&amp;temp, <span class="number">0</span>, sizeof<span class="params">(__Block_byref_temp_0)</span>, <span class="number">10</span>};
        void <span class="params">(*block)</span><span class="params">()</span> = <span class="params">(void <span class="params">(*)</span><span class="params">()</span>)</span>&amp;__main_block_impl_0<span class="params">(<span class="params">(void *)</span>__main_block_func_0, &amp;__main_block_desc_0_DATA, <span class="params">(__Block_byref_temp_0 *)</span>&amp;temp, <span class="number">570425344</span>)</span>;
        <span class="params">(temp.__forwarding-&gt;temp)</span> = <span class="number">20</span>;
        <span class="params">(<span class="params">(void <span class="params">(*)</span><span class="params">(__block_impl *)</span>)</span><span class="params">(<span class="params">(__block_impl *)</span>block)</span>-&gt;FuncPtr)</span><span class="params">(<span class="params">(__block_impl *)</span>block)</span>;
    }
    return <span class="number">0</span>;
}
</code></pre><p>这个时候我们看到，temp 已经不叫 temp 了。编译器生成了一堆以 下划线开头的 属性，但是我们还是可以找到，它是将 &amp;temp 的指针传进去了。</p>
<p>然后我们把 <code>(void (*)())</code> 强转的代码给删掉，方便阅读。接下来我们再看看 Block 本质是上面。</p>
<pre><code>void <span class="list">(<span class="keyword">*block</span>)</span><span class="list">()</span> = &amp;__main_block_impl_0<span class="list">(<span class="keyword">__main_block_func_0</span>, <span class="keyword">&amp;__main_block_desc_0_DATA</span>, temp)</span><span class="comment">;</span>
</code></pre><p>现在可以看出， Block 实际上就是一个指向 __main_block_impl_0 结构体的指针。</p>
<pre><code><span class="keyword">struct</span> __main_block_impl_0 {
  <span class="keyword">struct</span> __block_impl <span class="keyword">impl</span>;
  <span class="keyword">struct</span> __main_block_desc_0* Desc;
  <span class="keyword">int</span> temp;
  __main_block_impl_0(void *fp, <span class="keyword">struct</span> __main_block_desc_0 *desc, <span class="keyword">int</span> _temp, <span class="keyword">int</span> flags=<span class="number">0</span>) : temp(_temp) {
    <span class="keyword">impl</span>.isa = &amp;_NSConcreteStackBlock; 
    <span class="keyword">impl</span>.Flags = flags;
    <span class="keyword">impl</span>.FuncPtr = fp;
    Desc = desc;
  }
};
</code></pre><p>因为 C++ 结构体是有构造函数的，第四个参数为默认值，<code>temp(_temp)</code> 是将_temp的值赋值给 temp 。所以在函数中没有看到 对 temp 赋值的操作。搞定这个之后，我们再来看看 __main_block_func_0 函数里面到底是什么东西。</p>
<pre><code><span class="keyword">static</span> <span class="keyword">void</span> __main_block_func_0(<span class="keyword">struct</span> __main_block_impl_0 *__cself) {
  <span class="keyword">int</span> temp = __cself-&gt;temp; <span class="comment">// bound by copy</span>

            <span class="built_in">NSLog</span>((<span class="built_in">NSString</span> *)&amp;__<span class="built_in">NSConstantStringImpl__var_folders__g_yvmzw12106sgs14rz4yj_msw0000gn_T_main_c4b143_mi_0</span>, temp);
        }
</code></pre><p>看到我们熟悉的 NSLog , 到这里我们可以看出，Block 实际就是把我们写的所有 Block 代码生成一个函数，然后将函数指针传给了 __main_block_func_0 结构体，并同时把 temp 的值传到Block 里面，所以当 Block 在调用时候，实际上就是在调用函数。</p>
<h3 id="block_内存管理_Tips">block 内存管理 Tips</h3><pre><code>// <span class="number">1</span>.如果没有对<span class="keyword">block</span>进行copy操作，<span class="keyword">block</span>就存储于栈空间
// <span class="number">2</span>.如果对<span class="keyword">block</span>进行copy操作，<span class="keyword">block</span>就存储于堆空间
// <span class="number">3</span>.如果<span class="keyword">block</span>存储于栈空间，不会对<span class="keyword">block</span>内部所用到的对象产生强引用
// <span class="number">4</span>.如果<span class="keyword">block</span>存储于堆空间，就会对<span class="keyword">block</span>内部所用到的对象产生强引用
</code></pre>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/07/30/ios-notes-media-player/">
                iOS 学习笔记 —— 媒体播放
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-07-30
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/iOS/">iOS</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2013/07/30/ios-notes-media-player/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2013/07/30/ios-notes-media-player/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="iOS学习笔记之——媒体播放">iOS学习笔记之——媒体播放</h2><p>在iOS中提供了两种播放媒体的两个类:<code>MPMoviePlayerController</code>和<code>MPMoviePlayerViewController</code>，让我们可以轻松地播放媒体文件。其中<code>MPMoviePlayerViewController</code> 只能全屏播放，下面我们就来动手试一试吧。</p>
<h5 id="（一）导入依赖项">（一）导入依赖项</h5><p>在写代码之前我们需要引入一个依赖项到XCode：<code>MediaPlayer.Framework</code>。<br>图片。。。。<br><code>MPMoviePlayerController</code>内部有个view用来展示视频内容，添加其他<code>Controller</code>的View上面就可实现播放。目前支持的视频格式有<code>H.264</code>和<code>MPEG-4 Part 2 video</code>两种。支持的文件扩展名为：avi、mkv、mov、m4v、mp4等。可以到苹果官网下载一些用来测试的小<a href="http
://support.apple.com/kb/ht1424">视频文件</a>。沙盒里面取视频文件</p>
<h5 id="（二）动手写代码">（二）动手写代码</h5><p>新建一个<code>Controller</code>将头文件导入。</p>
<pre><code><span class="id">#import</span> <span class="string">"MainViewController.h"</span>
<span class="id">#import</span> &lt;MediaPlayer/MediaPlayer.h&gt;
</code></pre><p>声明一个属性</p>
<pre><code><span class="variable">@interface</span> MainViewController ()
<span class="variable">@property</span> (strong, nonatomic) MPMoviePlayerController *player;<span class="comment">//注意：如果定义在viewDidLoad中的话将会无法播放、因为出了`viewDidLoad`之后*player会被销毁掉了。</span>
<span class="variable">@property</span> (strong, nonatomic) UIImageView *imageView;
<span class="variable">@end</span>
</code></pre><p>接下来在<code>viewDidLoad</code>里面初始化视频播放器并添加到<code>RootViewController</code></p>
<pre><code><span class="built_in">NSURL</span> *url = [[<span class="built_in">NSBundle</span> mainBundle]URLForResource:<span class="string">@"promo_full"</span> withExtension:<span class="string">@"mp4"</span>];
 <span class="keyword">self</span><span class="variable">.player</span> = [[<span class="built_in">MPMoviePlayerController</span> alloc]initWithContentURL:url];
 [<span class="keyword">self</span><span class="variable">.player</span><span class="variable">.view</span> setFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">320</span>, <span class="number">180</span>)];   <span class="comment">//16:9比例</span>
 [<span class="keyword">self</span><span class="variable">.view</span> addSubview:<span class="keyword">self</span><span class="variable">.player</span><span class="variable">.view</span>];
 [<span class="keyword">self</span><span class="variable">.player</span> play];
</code></pre><p>到目前为止我们就可以实现播放视频了。是不是很简单？<br>图片。。。</p>
<h5 id="（三）思考">（三）思考</h5><p>通常我们使用主流的播放器一般都会有记录上次播放位置、视频页面截图、视频结束弹出广告，如何实现呢。这就需要通过通知中心，以观察者模式监视视频模仿的状态了,下面是一个播放时全屏的例子。</p>
<pre><code>[[NSNotificationCenter <span class="keyword">default</span>Center]addObserver:<span class="literal">self</span> selector:@selector(<span class="keyword">state</span>Listener) name:MPMoviePlayerPlaybackStateDidChangeNotification object:nil];
</code></pre><p>接着我们需要写一个监听方法在视频播放的时候<code>MPMoviePlaybackStatePlaying</code>来设置<code>Fullscreen</code>就可以了</p>
<pre><code>- (<span class="keyword">void</span>)stateListener
{
    <span class="keyword">if</span> (<span class="keyword">self</span><span class="variable">.player</span><span class="variable">.playbackState</span>==<span class="built_in">MPMoviePlaybackStatePlaying</span>) {
            [<span class="keyword">self</span><span class="variable">.player</span> setFullscreen:<span class="literal">YES</span> animated:<span class="literal">YES</span>];    <span class="comment">// 设置全屏播放</span>
            <span class="built_in">NSLog</span>(<span class="string">@"播放"</span>);
    }
}
<span class="keyword">@end</span>
</code></pre><p>接下来我们再来实现一个视频截图的功能，首先我们需要准备一个<code>UIImageView</code>加到<code>RootViewController</code>里面来显示我们的截图。</p>
<pre><code> [[<span class="built_in">NSNotificationCenter</span> defaultCenter]addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(caputerImage:) name:<span class="built_in">MPMoviePlayerThumbnailImageRequestDidFinishNotification</span> object:<span class="literal">nil</span>]; 

[<span class="keyword">self</span><span class="variable">.player</span> requestThumbnailImagesAtTimes:@[@<span class="number">10.0</span>f, @<span class="number">20.0</span>f] timeOption:<span class="built_in">MPMovieTimeOptionNearestKeyFrame</span>]; <span class="comment">//指定一个截图时间区间</span>
<span class="built_in">UIImageView</span> *thumbnailImageView = [[<span class="built_in">UIImageView</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">80</span>, <span class="number">200</span>, <span class="number">160</span>, <span class="number">90</span>)];
<span class="keyword">self</span><span class="variable">.imageView</span> = thumbnailImageView;
[<span class="keyword">self</span><span class="variable">.view</span> addSubview:thumbnailImageView];
</code></pre><p>接下来同样需要一个监听方法来完成截图功能。</p>
<pre><code>- (<span class="keyword">void</span>)caputerImage:(<span class="built_in">NSNotification</span> *)notification
{
    <span class="built_in">NSLog</span>(<span class="string">@"截图 %@"</span>, notification);
    <span class="built_in">UIImage</span> *image = notification<span class="variable">.userInfo</span>[<span class="string">@"MPMoviePlayerThumbnailImageKey"</span>];
    [<span class="keyword">self</span><span class="variable">.imageView</span> setImage:image];
}
</code></pre><h4 id="总结">总结</h4><p>基于苹果给我们封装了很多细节，我们可以很轻松的实现很多常用的功能。还有<code>MPMoviePlayerViewController</code>大体功能差不多就不一一介绍了。</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/07/19/ios-notes-sand-box/">
                iOS学习笔记 —— 沙盒机制（SandBox)
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-07-19
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/iOS/">iOS</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2013/07/19/ios-notes-sand-box/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2013/07/19/ios-notes-sand-box/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="沙盒是什么？">沙盒是什么？</h2><blockquote>
<p>在计算机安全领域，沙盒（英语：sandbox，又译为沙箱）是一种安全机制，为运行中的程序提供的隔离环境。通常是作为一些来源不可信、具破坏力或无法判定程序意图的程序提供实验之用。</p>
</blockquote>
<p>这种机制被苹果公司运用到了 iOS 平台上，每一个 APP 都有一个属于自己的沙盒，可以对其进行文件I/O操作，比如存取照片、音频、文本、属性列表等。但不可以访问其他 APP 的沙盒，每个 APP 都像是一个 <a href="https://zh.wikipedia.org/wiki/%E5%9C%B0%E7%90%86%E5%A4%A7%E5%8F%91%E7%8E%B0" target="_blank" rel="external">大航海时代之前</a> 的孤岛。</p>
<h2 id="如何使用以及怎么使用沙盒？">如何使用以及怎么使用沙盒？</h2><h5 id="沙盒其实就是一个文件夹，文件结构如下：">沙盒其实就是一个文件夹，文件结构如下：</h5><ul>
<li><p>Application Bundle：存放的是应用程序的源文件，包括资源文件和可执行文件。</p>
<p><code>NSString *path = [[NSBundle mainBundle] bundlePath];</code></p>
</li>
<li><p>Documents：iTunes会同步该文件夹内容。所以，苹果建议将程序中建立的 或 在程序中浏览到的文件数据保存在该文件夹下</p>
<pre><code><span class="built_in">NSString</span> *path = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>)<span class="variable">.lastObject</span>;
</code></pre></li>
</ul>
<ul>
<li><p>Library：</p>
<ul>
<li><p>Caches：适合存储体积大，不需要备份的非重要数据。</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *path = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSCachesDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>)<span class="variable">.lastObject</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>Preferences：APP 的偏好设置，所以iTunes会同步该文件夹内容。</p>
  <figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.获得NSUserDefaults文件</span></span><br><span class="line">NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.向文件中写入内容</span></span><br><span class="line">[userDefaults <span class="string">setObject:</span>@<span class="string">"userName"</span> <span class="string">forKey:</span>@<span class="string">"userName"</span>];</span><br><span class="line"><span class="comment">//2.1立即同步</span></span><br><span class="line">[userDefaults synchronize];</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.读取文件</span></span><br><span class="line">NSString *userName = [userDefaults <span class="string">objectForKey:</span>@<span class="string">"userName"</span>];</span><br></pre></td></tr></table></figure>
</li>
<li><p>tmp： 用于存放临时文件,系统在应用程序退出后不定时清除</p>
<p><code>NSString *path = NSTemporaryDirectory();</code></p>
</li>
</ul>
<h2 id="补充">补充</h2><ul>
<li>URL Scheme：通过URL Scheme 可以实现 App 之间互相调用，并且可以传递参数。</li>
<li>模拟器的沙盒存放路径<br>打开 Finder ，快捷键 <code>shift + cmd + G</code>  输入 <code>/Users/(你的机器名称)/Library/Application Support/iPhone Simulator/</code></li>
<li>便利小工具：<a href="http://simpholders.com/" target="_blank" rel="external">simpholders</a></li>
</ul>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2013/07/17/ios-notes-synthesize/">
                iOS 学习笔记 —— @synthesize合成指令
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2013-07-17
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/iOS/">iOS</a>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2013/07/17/ios-notes-synthesize/#comments" >
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2013/07/17/ios-notes-synthesize/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>许多编程语言中，在程序员编写一个<code>@property</code>时候，编译器为了减轻程序员的工作量都会自动给<code>@property</code>自动生成两个以下划线开头的成员变量，就跟下面一样。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="at_rule">@<span class="keyword">property</span> NSString *firstName</span>;</span><br></pre></td></tr></table></figure>
<p>因此 Xcode 4.4的以前的版本给程序员提供了 <code>@sythesize</code> 关键字来生成下划线开头的成员变量，每当声明一个属性之后都必须用 <code>@sythesize</code> 在 <code>implementation</code> 里面告诉编译器，编译器才会给生成下划线开头的成员变量方法。下面代码做个演示。</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">NSString</span> *someProperty;<span class="comment">//声明一个变量</span></span><br><span class="line"></span><br><span class="line">@sythesize someProperty = _someProperty； <span class="comment">// 必须使用 合成指令告诉编译器，其才会生成该属性需要的成员变量。</span></span><br></pre></td></tr></table></figure>
<p> 因为这样，Xcode 4.4以前版本的程序员做开发比较郁闷的时候，就是需要声明很多属性的时候就会出现一堆 <code>@sythesize</code> 。之后，苹果发现这个问题之后呢，在 Xcode 4.5以后的版本对其进行改进，不再需要程序员手动去调用 <code>@sythesize</code> 指令也可以自动生成带下划线的成员变量了。</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">parentViewController</span>（）</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) <span class="built_in">NSString</span> *someProperty; <span class="comment">//父类的属性</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">childViewController</span></span></span><br><span class="line">@sythesize someProperty = _someProperty；</span><br><span class="line">@(<span class="keyword">void</span>)someMethod</span><br><span class="line">&#123;</span><br><span class="line">	 <span class="keyword">self</span><span class="variable">.someProperty</span> <span class="comment">//循环引用..</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>这么一来简化了程序员的工作量，但是当成员变量出现在父类的情况下，子类如果需要调用父类的成员变量时，编译器不会给子类也生成相应的下划线成员变量。Xcode 则推荐我们使用<code>self</code>关键字。但是通过 <code>self.someProperty</code> 调用父类的成员变量时候，是调用属性的 <code>getter</code> 方法，<code>getter</code>  调用时候再 <code>getter</code> 自己的时候就会形成循环引用的问题。</p>
<p>明白了这个之后，往后在子类调用父类的变量时候，手动调用一下 <code>@sythesize</code> 就可以了。</p>
<p>参考：</p>
<p><a href="https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/EncapsulatingData/EncapsulatingData.html#//apple_ref/doc/uid/TP40011210-CH5-SW1" target="_blank" rel="external">Programming with Objective-C</a></p>
<p><a href="http://stackoverflow.com/questions/3266467/what-exactly-does-synthesize-do" target="_blank" rel="external">What exactly does @synthesize do?</a></p>
<p><a href="http://stackoverflow.com/questions/15606151/objective-c-is-synthesize-required-or-optional" target="_blank" rel="external">Objective-C is @synthesize required or optional?</a></p>
<p><a href="http://stackoverflow.com/questions/9368676/under-what-conditions-is-synthesize-automatic-in-objective-c/11767553#11767553" target="_blank" rel="external">Under what conditions is @synthesize automatic in Objective-c?</a></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
  </div>

  

        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <div class="site-overview">
        <div class="site-author motion-element">
          <img class="site-author-image" src="https://avatars0.githubusercontent.com/u/4646907?v=3&s=460" alt="typore" />
          <p class="site-author-name">typore</p>
        </div>
        <p class="site-description motion-element"></p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">9</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">2</span>
              <span class="site-state-item-name">categories</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            
              <span class="site-state-item-count">3</span>
              <span class="site-state-item-name">tags</span>
              
          </div>

        </div>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
              <a href="https://github.com/potocol" target="_blank">github</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://twitter.com/easySmartv" target="_blank">twitter</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://weibo.com/712387780" target="_blank">weibo</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://www.zhihu.com/people/smartv" target="_blank">zhihu</a>
            </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>
        
      </div>

      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp; 
  2015
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">typore</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.3"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.3"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.3" id="motion.global"></script>



  <script type="text/javascript" src="/js/search-toggle.js"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  

  
  
  

  

    <script type="text/javascript">
      var disqus_shortname = 'smartv';
      var disqus_identifier = 'index.html';
      var disqus_title = '';
      var disqus_url = '';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
    </script>
  




  
  

  
  <!-- lazyload -->
  <script type="text/javascript" src="/js/lazyload.js"></script>
      <script type="text/javascript">
        jQuery(function() {          
            jQuery("#posts img").lazyload({
              placeholder:"http://www.arao.me/loading.gif",  
                effect:"fadeIn"
              });
            });
    </script>   
</body>
</html>
